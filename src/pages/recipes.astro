---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import RecipesClient from '../components/RecipesClient.astro';

const allRecipes = await getCollection('recipes');

// Prepare recipes data
const recipesData = allRecipes.map((recipe) => {
  return {
    id: recipe.id,
    title: recipe.data.title,
    tags: recipe.data.tags || [],
    source: recipe.data.source,
    notes: recipe.data.notes,
    type: recipe.data.type,
    slug: recipe.slug.includes('custom-recipes') ? `/custom-recipes/${recipe.slug.split('/')[1]}` : null,
    image: recipe.data.image,
  };
});

const keywords = ['karlo delalic', 'portfolio', 'distributed systems', 'software engineer', 'recipes'];
---

<BaseLayout title="Recipes" keywords={keywords}>
  <Header slot="header" />
  <RecipesClient recipes={recipesData} />
</BaseLayout>
